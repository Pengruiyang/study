
1. 输入 url 判断是 url 还是搜索引擎 搜索引擎组装拼接 url 链接 ,url 直接搜索
2. 浏览器进程构建请求行,转发给网络进程进行请求
3. 网络进程获取到 url 地址  先判断缓存中是否有 有直接拦截请求从缓存中返回并返回 200 如果没有,进行 dns 查询.
  >先看 dns 缓存中是否有当前域名信息 ip 地址和端口号  有的直接返回
  解析顺序是从 浏览器缓存、操作系统缓存、本地 dns 缓存逐级查找,
  从本地 DNS服务器、根 DNS、顶级 DNS 以及权威 DNS 层层递归查询.
  没有的话从 13 个配置文件中查询 根域名开始 .com => .baidu.com => www.baodu.com
  >拿到对应的域名信息存入缓存中 https 端口默认 443 http 默认 80 

  如果是 https 请求还需要 tls/ssl
  >客户端发送 协议版本号、随机数(random1)、支持的加密方式 到服务端 
  服务端接收到客户端请求 向客户端传递公钥 证书 版本 过期时间等信息 服务器生成一个随机数(random2)
  客户端拿到证书后解析判断是否合法 不合法直接地址栏提示危险
  合法通过(random1 + random2)生成 pre - master并通过公钥加密并传输给服务端
  服务端拿到加密的随机数以后用私钥对解密得到随机数 
 > 之后服务端 客户端用这三个随机数生成 对话密钥 加密之后所有的数据传输
4. chrome 最多对统一域名建立 6 个tcp 链接,有更多的则需要排队等候,建立 tcp 链接
5. 三次握手建立 tcp 链接(tcp 可靠传输的体现)
> 客户端主动发起SYN(同步序列编号) ( a => b 我要通信了)
  服务端收到并返回 SYN已经 ACK (确认字符)客户端的 SYN (b => a 我可以接受数据,你能接受数据吗)
  客户端接收到服务端的 SYN 和 ACK 后,发送 ACK 的 ACK 给服务端,服务端收到后建立连接 ( a => b 我可以接受到)
>
 
6. 构建请求头 发送请求头 
 传输层 http 请求加上 tcp 头部 源端口号和目标端口号 校验完整性的序号 
 网络层 在数据包上加上源 ip 地址目标 ip 地址
 通过底层网络传输到目标服务器
7. 接收请求头 解析请求头
   网络层 接收数据包 解析数据包 获取 ip 地址 向上传输
   传输层 接收数据包 获取端口号 向上传输至应用层
8.应用层 解析请求头 获取请求体 判断是否需要重定向 如果需要返回 301/ 302 并附加上 location 地址 如果不需要根据请求头中 etag 中 If-None-Match 、Last-Modified中 if - Modified -since 共同判断是否需要协商缓存 如果有直接返回 304 ,若否 返回 200  并返回新数据 
顺着应用层 - 传输层 - 网络层 - 底层 - 网络层 - 传输层 -应用层
9. 数据传输完成, 判断 tcp 链接是否有 connection : keep-alive 字段保持链接 没有 则 tcp 四次挥手
  >**客户端发送 FIN(结束指令) 给服务端,用来关闭客户端到服务器的数据传送**
  a => b 我要断开链接  主动关闭 进入半终止状态
  **服务器接收到 FIN 后发送 ACK 给客户端**
  b => a 接受到关闭信息 b 也准备断开链接
  **服务器关闭客户端连接后,发送一个 FIN 给客户端**
  b => a b 我断开链接了
  **客户端收到后,ACK 报文确认给服务端,服务端关闭**
  a => b 好吧你关闭 ,我也关闭了
  > 等待 2ms 时间断开链接 2ms 主要怕最后一个包对面没有接收到

10. 客户端将拿到的数据包进行解析 根据响应头的 Content-type 判断响应数据的类型 ,如果是字节流类型 则交给下载进程.如果是 text/html,通知浏览器获取到文档准备渲染
11. 渲染进程判断时候打开过同一个站点(根域名 协议一样就是),如果是 复用渲染进程,否则打开一个新的渲染进程
12. 渲染进程接收到消息后,和网络进程建立传输数据的 管道,直到文件数据传输完成后通知浏览器进程改变页面状态
13. 渲染进程对页面进行解析,资源加载
  渲染流程总结
    > 渲染进程将 HTML 内容转换为能够读懂的 Dom 树结构
    渲染引擎将css 转换为浏览器理解的 styleSheets,计算出 dom 样式.
    创建布局树 , dom 树不同的是只有可见节点,计算元素布局信息
    对布局树进行分层,并生成分层树
    对每个图层生成绘制列表 提交到合成线程
    合成线程将图层分为图块, 在光栅化线程池中将图块转换为位图
    合成线程发送绘制图块命令给浏览器进程 展示到显示器上